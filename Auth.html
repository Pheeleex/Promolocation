<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Login</title>
    <link rel="stylesheet" href="css/Auth.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="login-container">
      <div class="logo-wrapper">
        <img src="./assets/auth-logo.png" alt="Logo" class="logo" />
      </div>

      <h1>Admin Login</h1>

      <form class="login-form">
        <div class="input-group">
          <label for="userid">Enter Your User ID/Email</label>
          <input type="text" id="userid" placeholder="Email..." />
        </div>

        <div class="input-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="Password...." />
        </div>

        <button type="submit" class="login-btn">Login</button>
      </form>
    </div>

    <script>
      const loginForm = document.querySelector(".login-form");
      const userInput = document.getElementById("userid");
      const passwordInput = document.getElementById("password");

      // -------------------------------
      // Dummy Users Database
      // -------------------------------
      const users = [
        {
          id: "12345",
          email: "admin1@email.com",
          name: "Admin One",
          password: "17122002",
        },
        {
          id: "67890",
          email: "admin2@email.com",
          name: "Admin Two",
          password: "17122002",
        },
        {
          id: "54321",
          email: "manager@email.com",
          name: "Manager",
          password: "17122002",
        },
      ];

      // -------------------------------
      // Redirect if already logged in
      // -------------------------------
      const existingUser = localStorage.getItem("authUser");

      if (existingUser) {
        window.location.href = "promoters.html"; // default page after login
      }

      // -------------------------------
      // Real-time clear error
      // -------------------------------
      userInput.addEventListener("input", () => {
        userInput.classList.remove("input-error");
      });

      passwordInput.addEventListener("input", () => {
        passwordInput.classList.remove("input-error");
      });

      // -------------------------------
      // Login Logic
      // -------------------------------
      loginForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const userValue = userInput.value.trim();
        const passwordValue = passwordInput.value.trim();

        userInput.classList.remove("input-error");
        passwordInput.classList.remove("input-error");

        if (!userValue && !passwordValue) {
          userInput.classList.add("input-error");
          passwordInput.classList.add("input-error");
          return;
        }

        if (!userValue) {
          userInput.classList.add("input-error");
          userInput.focus();
          return;
        }

        if (!passwordValue) {
          passwordInput.classList.add("input-error");
          passwordInput.focus();
          return;
        }

        // -------------------------------
        // Check if user exists
        // -------------------------------
        const foundUser = users.find(
          (user) =>
            (user.id === userValue || user.email === userValue) &&
            user.password === passwordValue,
        );

        if (!foundUser) {
          Swal.fire({
            icon: "error",
            title: "Login Failed",
            text: "Invalid ID/Email or Password",
            confirmButtonColor: "#d33",
          });
          return;
        }

        // -------------------------------
        // Store user session
        // -------------------------------
        localStorage.setItem(
          "authUser",
          JSON.stringify({
            id: foundUser.id,
            email: foundUser.email,
            name: foundUser.name,
          }),
        );

        // Redirect to default page
        window.location.href = "promoters.html";
      });
    </script>
  </body>
</html>
